# vue数据劫持



- 作用:重新定义 `data` 原数据上的属性，将其定义响应式属性

  详细版:

  调用 `observe` 方法开始数据劫持，传入 `data` 原数据

  判断数据是否是对象或数组，是的话才会开始真正的工作 `new Obverser(data)`

  内部通过`Object.keys`方法提取原`data`数据的所有属性名成为一个数组

  遍历这个数组,提取属性名和属性值,调用`defineReactive`方法将其定义成响应式

  先`new Dep`生成`dep`对象,这个`dep`可以做两件事

  - 可以通过建立响应式联系(`dep.depend`)
  - 可以触发响应式更新(`dep.notify`)
  - 每个响应式数据都会产生一个自己`dep`,它是唯一的

  递归调用`observe`函数,对属性值进行处理

  - 它的目的为了确保所有的数据(对象上对象的数据)都变成响应式

  通过`Object.defineProperty`方法给原数据`data`重新定义属性,定义其属性`get`和`set`方法

  - `get`方法会返回原数据(内部会有`dep.depend`方法)
  - `set`方法设置新值,通过调用`observe`方法将新值重新定义成响应式(内部会有`dep.notity`方法)
  - 确保将来所有的`data`数据都是响应式(不管是之前的,还是新添加的)

  此时`data`数据就全部重新定义了,定义成响应式,响应式的关键点还是看下一步

  简单版:

  - 内部会递归遍历所有`data`数据,将其定义成响应式
  - 每一个响应是数据都会产生一个自己的`dep`,他是唯一的,和响应式关系很大
  - 通过`Object.defineProperty`方法给元数据`data`重新定义属性,定义其属性`get`和`set`方法